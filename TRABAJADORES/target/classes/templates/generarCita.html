<!DOCTYPE html>
<html lang="en">

<head>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
</head>

<body>
    <!-- Main content -->
    <main class="container-fluid px-4">
        <div class="card bg-light my-4">
            <div class="card-header py-3">
                <svg class="svg-inline--fa fa-table me-1" aria-hidden="true" focusable="false" data-prefix="fas"
                    data-icon="table" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"
                    data-fa-i2svg="">
                    <path fill="currentColor"
                        d="M448 32C483.3 32 512 60.65 512 96V416C512 451.3 483.3 480 448 480H64C28.65 480 0 451.3 0 416V96C0 60.65 28.65 32 64 32H448zM224 256V160H64V256H224zM64 320V416H224V320H64zM288 416H448V320H288V416zM448 256V160H288V256H448z">
                    </path>
                </svg>Generar Cita
            </div>
            <div class="card-body">
                <input type="search" placeholder="Tarjeta Sanitaria" name="value" id="value">
                <button onclick="loadDoc()" class="btn btn-primary btn-sm align-top">Buscar</button>

                <div class="dataTable-container mt-2">
                    <table id="datatablesSimple" class="datatablesSimple">
                        <thead>
                            <tr>
                                <th scope="col">Tarjeta Sanitaria</th>
                                <th scope="col">Nombre</th>
                                <th scope="col">Apellido1</th>
                                <th scope="col">Apellido2</th>
                                <th scope="col">Categoría</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="paciente: ${news}">
                                <td th:text="${paciente.tarjetaSanitaria}"></td>
                                <td th:text="${paciente.nombre}"></td>
                                <td th:text="${paciente.apellido1}"></td>
                                <td th:text="${paciente.apellido2}"></td>
                                <!-- AÑADIR TH categoria -->
                                <td><span class="badge bg-danger">GRAVE</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="container">
                    <div class="row">
                        <div class="col ps-0">
                            <div class="card d-none" id="fecha">
                                <p class="card-header">Fecha de la cita</p>
                                <div class="card-body p-3">
                                    <input type="date" id="start" name="trip-start" value="actual" min="actual"
                                        max="2999-12-31">
                                </div>
                            </div>
                        </div>
                        <div class="col pe-0">
                            <div class="card d-none" id="hora">
                                <p class="card-header">Hora de la cita</p>
                                <div class="card-body p-3">
                                    <input type="time" id="appt" name="appt" min="7:30" max="20:00" required>
                                </div>
                            </div>
                        </div>
                    </div>
                    <br>
                </div>

                <div class="container">
                    <div class="row">
                        <div class="col text-center">
                            <!-- Añadir interacción -->
                            <button type="submit" class="btn btn-primary w-50 d-none" id="generar">Generar Cita</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</body>

</html>

<script>
    function loadDoc() {
        if (!document.getElementById('value').value.trim().length) {
            alert("Introduzca una tarjeta sanitaria porfavor");
        } else {
            $.ajax({
                type: "POST",
                url: "/busqueda",
                data: {
                    tr: $("#value").val(),
                },
                success: function (result) {
                    document.getElementById("fecha").classList.remove("d-none");
                    document.getElementById("hora").classList.remove("d-none");
                    document.getElementById("generar").classList.remove("d-none");
                    alert('ok');
                },
                error: function (result) {
                    alert('error');
                }
            });
        }
    }
</script>